<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Brian's Pizza Palace</title>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.css" />
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js"></script>
    <script src="js/cordova.js"></script>
    <script src="http://debug.phonegap.com/target/target-script-min.js#BrewerBrian"></script>
</head>
<body>
    <div data-role="page" id="home">
        <header data-role="header" data-theme="e" data-id="navbar" data-position="fixed">
            <h2>Brian's Pizza Palace</h2>
            <div data-role="navbar">
                <ul class="ui-body-e">
                    <li><a href="#home" class="ui-btn-active ui-state-persist">Home</a></li>
                    <li><a href="#call">CALL US</a></li>
                    <li><a href="#menu">Menu</a></li>
                    <li><a href="#order">Order</a></li>
                    <li><a href="#loc">Location</a></li>
                    <li><a href="#about">About Us</a></li>
                </ul>
            </div>
        </header>
        <div data-role="content">
            <h2>Welcome</h2><p>Brian's Pizza Palace is Spokane's best handmade brick-oven baked pizzas the world has ever tasted. Wash down every bite with a pint of our twelve handcraft beers. Brewed by Brewmaster John John, every beer is developed by several phases where the final recipe is written into his grimoire of many potions.</p>
        </div>
        <div data-role="footer" data-theme="e" data-position="fixed">
            Footer
        </div>
    </div>

    <div data-role="page" id="call">
        <header data-role="header" data-theme="e" data-id="navbar" data-position="fixed">
            <h2>Brian's Pizza Palace</h2>
            <div data-role="navbar">
                <ul class="ui-body-e">
                    <li><a href="#home">Home</a></li>
                    <li><a href="#call" class="ui-btn-active ui-state-persist">CALL US</a></li>
                    <li><a href="#menu">Menu</a></li>
                    <li><a href="#order">Order</a></li>
                    <li><a href="#loc">Location</a></li>
                    <li><a href="#about">About Us</a></li>
                </ul>
            </div>
        </header>
        <div data-role="content">
            <p>If you would like to give us a call, you can each us at</p><br>
                <a href="tel:509-345-6789" data-role="button">509-345-6789</a>

        </div>
        <div data-role="footer" data-theme="e" data-position="fixed">
            Footer
        </div>
    </div>

    <div data-role="page" id="menu">
        <header data-role="header" data-theme="e" data-id="navbar" data-position="fixed">
            <h2>Brian's Pizza Palace</h2>
            <div data-role="navbar">
                <ul class="ui-body-e">
                    <li><a href="#home">Home</a></li>
                    <li><a href="#call">CALL US</a></li>
                    <li><a href="#menu" class="ui-btn-active ui-state-persist">Menu</a></li>
                    <li><a href="#order">Order</a></li>
                    <li><a href="#loc">Location</a></li>
                    <li><a href="#about">About Us</a></li>
                </ul>
            </div>
        </header>
        <div data-role="content">
            <div data-product="1000" class="product">
                <span data-name='Classic New York Pew Pew Peperoni'></span>
                <span data-price='14.95'>14.95</span>
                <span data-desc='description'>A Tasty New Your style Peperoni pizza</span>
            </div>

            <div data-product="2000" class="product">
                <span data-name='The Massive Meatie Monster'></span>
                <span data-price='19.95'>19.95</span>
                <span data-desc='description'>A giant of a pizza, layered with over 4 lbs of meats and sausages topped with a layer of cheese</span>
            </div>

            <div data-product="3000" class="product">
                <span data-name='The Very Veggie Value Pi'></span>
                <span data-price='11.95'>11.95</span>
                <span data-desc='description'>A student's favorite pick. Walk away full and know you ate the best veggie pizza this side of the Cascades.</span>
            </div>

            <div data-product="4000" class="product">
                <span data-name='Four Cheese Italian MathPow Calzone'></span>
                <span data-price='12.95'>12.95</span>
                <span data-desc='description'>A pie made with four class "A" italian cheeses with two toppings of your choice.</span>
            </div>

            <div data-product="5000" class="product">
                <span data-name='Linux Lasagna'></span>
                <span data-price='24.95'>24.95</span>
                <span data-desc='description'>Brian's Web famous Linux Lasagna. Layer after layer of smoked tomatoes and choice sausage meats blended with 6 cheeses. So good, it will make you see code.</span>
            </div>
        </div>
        <div data-role="footer" data-theme="e" data-position="fixed">
            Footer
        </div>
    </div>

    <div data-role="page" id="order">
        <header data-role="header" data-theme="e" data-id="navbar" data-position="fixed">
            <h2>Brian's Pizza Palace</h2>
            <div data-role="navbar">
                <ul class="ui-body-e">
                    <li><a href="#home">Home</a></li>
                    <li><a href="#call">CALL US</a></li>
                    <li><a href="#menu">Menu</a></li>
                    <li><a href="#order" class="ui-btn-active ui-state-persist">Order</a></li>
                    <li><a href="#loc">Location</a></li>
                    <li><a href="#about">About Us</a></li>
                </ul>
            </div>
        </header>
        <div data-role="content">

            <div id="cartDiv">

            </div>
            <div>
                <button id="buy">Order Now</button>
            </div>
            <div>
                <button id="save">Save Order</button>
            </div>
            <div>
                <button id="load">Load Order</button>
            </div>
        </div>
        <div data-role="footer" data-theme="e" data-position="fixed">
            Footer
        </div>
    </div>

    <div data-role="page" id="loc">
        <header data-role="header" data-theme="e" data-id="navbar" data-position="fixed">
            <h2>Brian's Pizza Palace</h2>
            <div data-role="navbar">
                <ul class="ui-body-e">
                    <li><a href="#home">Home</a></li>
                    <li><a href="#call">CALL US</a></li>
                    <li><a href="#menu">Menu</a></li>
                    <li><a href="#order">Order</a></li>
                    <li><a href="#loc" class="ui-btn-active ui-state-persist">Location</a></li>
                    <li><a href="#about">About Us</a></li>
                </ul>
            </div>
        </header>
        <div data-role="content">
            <script>
                navigator.geolocation.getCurrentPosition(function(pos) {
                    var lat = pos.coords.latitude;
                    var long = pos.coords.longitude;
                    $("#lat").text( lat );
                    $("#long").text( long );
                    var url = '<a href="https://maps.google.com/maps?daddr=Benniditos+Pizza,+1426+South+Lincoln+Street,+Spokane,+WA+99203&saddr=' + lat +',' + long + '">Your Location </a>';
                    $("#url").append( url );
                    var map = '<iframe width="425" height="520" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="https://maps.google.com/maps?daddr=Benniditos+Pizza,+1426+South+Lincoln+Street,+Spokane,+WA+99203&amp;saddr=' + lat + ',' + long +'&amp;ie=UTF8&amp;t=h&amp;geocode=FRw31wIdgTgA-Q%3BFWP11gId-z4A-SEdKrwUc1NwFynf_9O4dhieVDEdKrwUc1NwFw&amp;ll=47.650501,-117.425351&amp;spn=0.015033,0.018239&amp;z=15&amp;output=embed"></iframe><br /><small><a href="https://maps.google.com/maps?daddr=Benniditos+Pizza,+1426+South+Lincoln+Street,+Spokane,+WA+99203&amp;saddr=47.65878000000001,-117.426047&amp;ie=UTF8&amp;t=h&amp;geocode=FRw31wIdgTgA-Q%3BFWP11gId-z4A-SEdKrwUc1NwFynf_9O4dhieVDEdKrwUc1NwFw&amp;ll=47.650501,-117.425351&amp;spn=0.015033,0.018239&amp;z=15&amp;source=embed" style="color:#0000FF;text-align:left">View Larger Map</a></small>'
                    $("#map").html(map);
                })
            </script>
            <div id="map"></div>
            <div>
                <!-- change this to phoneGap plugin file to fire --> <!-- TODO Change href to phoneGap API file -->
                <a data-role="button" href="compass.html">Compass</a>
            </div>
        </div>
        <div data-role="footer" data-theme="e" data-position="fixed">
            Footer
        </div>
    </div>

    <div data-role="page" id="about">
        <header data-role="header" data-theme="e" data-id="navbar" data-position="fixed">
            <h2>Brian's Pizza Palace</h2>
            <div data-role="navbar">
                <ul class="ui-body-e">
                    <li><a href="#home">Home</a></li>
                    <li><a href="#call">CALL US</a></li>
                    <li><a href="#menu">Menu</a></li>
                    <li><a href="#order">Order</a></li>
                    <li><a href="#loc">Location</a></li>
                    <li><a href="#about" class="ui-btn-active">About Us</a></li>
                </ul>
            </div>
        </header>
        <div data-role="content">
            <h2>About Us</h2>
            <p>We have been in business since 1998 where I decided to become my own boss thought I would start a business doing something I enjoy, Pizza. I have always loved pizza and find great fun in creating new styles and flavors. Using only fresh organic ingredients, our pizzas are cooked in brick ovens where we use various woods to enhance the flavor of the dough. Truly a delicious addition. Stop by or order out and try our great pizzas.</p>
        </div>
        <div data-role="footer" data-theme="e" data-position="fixed">
            Footer
        </div>
    </div>
<script>
    var cart = [];

    function displayCart(){
        var cartDiv = $('#cartDiv');
        cartDiv.html("");
        var grandTotal = 0;
        for(var item in cart) {
            var qty = cart[item].qty;
            var price = cart[item].price;
            var subtotal = qty * price;
            grandTotal += subtotal;
            cartDiv.append('<p>' + qty + ': ' + cart[item].name + ' '
                    + price.toFixed(2) + '=='
                    + subtotal.toFixed(2) + '</p>');
        }

        cartDiv.append( '<p>Total Due: $' + grandTotal.toFixed(2) + '</p>');
    }

    $(document).ready(function(){


        // Show localStorage, If any ------->>>>>>
            var obj = JSON.parse( localStorage.getItem('cart') );
            for(  var item in obj ) {
                var pid = obj[item].pid;
                cart[ pid ] = obj[item];
            }
            displayCart();
        // END localStorage Show ------->>>>>>

        //Add a buy button to each of my pizzas
        $('div[data-product]').each( function(){
            $(this).append('<button class="btnCart">Add to Cart</button>');
        })

        // Add item to cart
        $('.btnCart').on("click", function(event){
            var pid = $(this).parent().parent().data("product");
            console.log( pid );
            if( cart[pid] ) {
                cart[pid].qty += 1;
            } else {
                cart[pid] = new Object();
                cart[pid].qty = 1;
                cart[pid].pid = pid;
                cart[pid].name = $(this).parent().siblings("span").data("name");
                cart[pid].price = $(this).parent().siblings("span").next().data("price");
            }
            displayCart();
        })

        // Place Order
        $('#buy').click(function(){

            $.post("buy.php", $("#mycontactform").serialize(),  function(data) {   });

            $('#success').html('Message sent!');
            $('#success').hide(2000);

        });

/*        $("#buy").on("click", function(event){
            var buyUrl = "";
            for ( var item in cart ) {
                buyUrl += "&pid[]=" + item + "&qty[]=" + cart[item].qty;
            }

            $.getJSON( 'buy.php?' + buyUrl, function(data){
                $("#cartDiv").append(data); // TODO ----Does not work at all. PHP is not firing
            })
            console.log( "http://www.perpetualmotionsquad.org/buy.php?" + buyUrl);
        })*/

        // Save Button
        $('#save').on("click", function(event){
            var cartStr = "[";
            for ( var item in cart ) {
                cartStr += JSON.stringify( cart[item] ) + ",";
            }
            cartStr = cartStr.slice(0,-1);
            cartStr += "]";
            console.log(cartStr);
            localStorage['cart'] = cartStr;
        })

        // Load Button
        $('#load').on("click", function(event){
            cart = [];
            var obj = JSON.parse( localStorage['cart'] );
            for(  var item in obj ) {
                var pid = obj[item].pid;
                cart[ pid ] = obj[item];
            }
            displayCart();
        })
    })
</script>
</body>


</html>